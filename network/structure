drop database if exists social_network;
create database social_network char set utf8;
use social_network;
select database();

CREATE TABLE users(
	id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(120) NOT NULL UNIQUE,
    created_at TIMESTAMP DEFAULT NOW());

 CREATE TABLE alboms(
	id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    alboms_name varchar (50) not null,
	users_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT NOW());

CREATE TABLE photos(
	id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    image_url VARCHAR(255) NOT NULL,
    users_id INT NOT NULL,
    alboms_id int not null,
    created_at TIMESTAMP DEFAULT NOW());

CREATE TABLE messages(
	id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    comment_text VARCHAR(255) NOT NULL,
    photos_id INT NOT NULL,
    users_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT NOW());

 create table ph_mes (
    photos_id int not null,
    messages_id int not null,
    users_id int not null,
    primary key (messages_id, users_id));

CREATE INDEX idx_username ON users(username);

ALTER TABLE photos ADD FOREIGN KEY (alboms_id) REFERENCES alboms(id);
ALTER TABLE alboms add foreign key (users_id) REFERENCES users(id);
ALTER TABLE ph_mes ADD FOREIGN KEY (photos_id) REFERENCES photos(id);
ALTER TABLE ph_mes ADD FOREIGN KEY (messages_id) REFERENCES messages(id);
ALTER TABLE messages ADD FOREIGN KEY (users_id) REFERENCES users(id);

insert into users (username) values ('Андрій'), ('Тамара'), ('Роман'), ('Вероніка'), ('Оксана'), ('Іван'), ('Петро'), ('Ярина'), ('Остап'), ('Павло'), ('Ірина');
insert into alboms ( alboms_name, users_id) values ('Відпочинок',1), ('Ліс',2), ('Озеро',3), ('Гриби',4), ('Подорож',5), ('Дача',6), ('Гори',7),
												   ('Авто',8), ('Робота',9), ('Навчання',10), ('Діти',11);
insert into photos (image_url, users_id, alboms_id) values ('http://elijah.biz', 1, 11), ('https://shanon.org', 2 , 10), ('http://vicky.biz', 3, 9),
('http://oleta.net', 4, 8), ('https://jennings.biz', 5, 7), ('https://quinn.biz', 6, 6), ('https://selina.name', 7, 5), ('http://malvina.org', 8, 4),
('https://branson.biz', 9, 3), ('https://elenor.name', 10, 2), ('https://marcelino.com', 11, 1);
insert into messages (comment_text, photos_id, users_id) values ('Знову навчання', 10, 1), ('Улюблена робота', 9, 2), ('Класна тачка', 8, 3), ('Неймовірні гори', 7, 4),
('Відпочинок на дачі додає радості', 6, 5), ('Незабутня подорож', 5, 6), ('Оце гриби!!!', 4, 7), ('Люблю купатись', 3, 8), ('Хочу тож у ліс', 2, 9),
('Відпочинок додає настрою', 11, 10), ('Чудові помічники', 1, 11);